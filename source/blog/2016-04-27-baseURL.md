---
title: Upcoming deprecation of baseURL in Ember-CLI 2.7
author: Nathan Hammond
tags: Recent Posts, Ember-CLI
---

The `baseURL` configuration option and accompanying `<base>` head tag in Ember-CLI applications are often and tragically misunderstood. There have been [at least 67 issues](https://github.com/ember-cli/ember-cli/search?q=baseURL&type=issues) opened for Ember-CLI referencing this part of our asset tooling. **[In Ember-CLI's canary channel, we're deprecating `baseURL` and removing the `<base>` tag's default presence in `index.html`.](https://github.com/ember-cli/ember-cli/pull/5792)** The intent is that this change will be released with Ember-CLI 2.7 stable in roughly 10 weeks.

Existing applications are allowed to continue using `baseURL` with a deprecation warning. For the many developers who are eager to adopt this change, you should note that the removal of `<base>` will impact how your application is deployed and likely require some small migration effort.

This is the culmination of a lot of research and work by [Tobias Bieniek](https://github.com/Turbo87) and we're incredibly grateful for his efforts.

### What was it?

`baseURL` allowed an Ember application and assets to be deployed to a subdirectory without requiring Ember-CLI to rewrite all asset URLs. For example in given an HTML file:

```html
<head>
  <base href="http://emberapp.io/strange-assets/">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <img src="image.png">
</body>
```

The style would be fetched from `http://emberapp.io/strange-assets/style.css`, and the image from `http://emberapp.io/strange-assets/image.png`. If you are curious, [here is a good read on the base tag](http://webdesign.tutsplus.com/articles/quick-tip-set-relative-urls-with-the-base-tag--cms-21399). In short, `baseURL` is configuration property Ember-CLI uses to identify what value to put in the `<base href="..." />` tag included in `index.html`. This determines where assets external to the application live, including `app.js`, `vendor.js`, `app.css`, and anything else that isn't specified with a fully-qualified path.

Variations on the `baseURL` solution has been Ember-CLIs default asset prefixing behavior for [two years](https://github.com/ember-cli/ember-cli/commit/404091401400478ef55088888b8ec383e02a17d6#diff-b785f57fd6a80a44da40bd76e531d8ecR11).

### Why are we deprecating it?

There are a number of reasons why we're moving away from this pattern, but a few things really made it unnecessarily complicated.

#### API Design Bugs

In Ember-CLI 2.5, apps can have both `baseURL` and `rootURL` configuration values. These two names are far too similar and do things which are far too similar. Where `baseURL` identified the asset prefix of an application, `rootURL` identifies the path at which an Ember application is hosted (so Ember's router can know which segments to ignore).

#### Implicit Behavior

Not only are there two confusing configuration options, but if only one of `baseURL` or `rootURL` is set Ember-CLI attempts to intuit the other's value. This implicit behavior violated the principle of least surprise for many people. An explicit requirement for both values and clearer documentation would have averted some of the pain.

#### Integration With Other Applications

Not every Ember application is full green field development. If you happened to have legacy user-generated HTML, or other data containing had relative links, this didn't play nicely with the `<base>` tag. Rewriting this content is an option, but incurs cost and bugs more simply avoided by not including the `<base>` tag.

#### SVG

Worst of all, and something that we can't code around, SVG `<use>` elements break in an unexpected and difficult to diagose way when used with a `<base>` tag present. It turns out that `<use xlink:xhref="#__SVG_ID__"></use>` doesn't play nicely with the `<base>` tag, instead the `xlink:xhref` value must also include the `base` href value. We like to play nicely with the web ecosystem and this fault is the final straw that pushed Ember-CLI core toward removing the `<base>` tag.

### How Do I Migrate?

Existing applications can continue to use the `baseURL` option and `<base>` tag with a deprecation warning.

For users who do want to migrate, the steps depend primarily on how your application is deployed. It's our goal is to make it easy for you to achieve the same behaviors you've had in the past. In an uncustomized Ember-CLI application you will likely not encounter any issue. We've been very careful to make sure that the out of the box experience is as smooth as possible.

//TODO total confusion.
From this point forward in `config/environment.js` you should simply set the `rootURL` property on the `ENV` object to where your application will appear on the server:

```javascript
module.exports = function(environment) {
  var ENV = {
    /* ... */
    rootURL: '/path/to/application/'
    /* ... */
  };

  return ENV;
}
```

#### Upgrading

If you are upgrading your application to the new version of Ember-CLI (canary with this change, or eventually 2.7 stable), you should pay close attention to the configuration changes inside of [the](https://github.com/ember-cli/ember-cli/pull/5792/files#diff-42e917b9304df0e99048f335019647bc) [modified](https://github.com/ember-cli/ember-cli/pull/5792/files#diff-f4d09ffc13efe496dd246031d423e166) [blueprint](https://github.com/ember-cli/ember-cli/pull/5792/files#diff-9588ab8abb99afa6cac30dd0e2b86041) [files](https://github.com/ember-cli/ember-cli/pull/5792/files#diff-3b0f91e0e9f317eecebfad38da2f9b4c). We have also inserted deprecation warnings which will hopefully guide you through each of these changes.

// TODO example?

#### How To Use a CDN

The most common use case for `baseURL` was pointing to assets on a CDN. After this change, you should not use the `prepend` option for [`broccoli-asset-rev`](https://github.com/rickharrison/broccoli-asset-rev), which is included with Ember-CLI apps by default. For example:

```javascript
var app = new EmberApp(defaults, {
  // Add options here
  fingerprint: {
    prepend: 'https://cdn.example.com/'
  }
});
```

// TODO "this removes the entire?"
Note that this option only applies when doing *production* builds via something like `ember build --prod`. This removes the entire `rootURL` path and only includes as path segments the ones which occur inside of `index.html`.

#### CSS, Fonts, and Other Static Assets

Depending upon how these were included into an application, their paths may need to be adjusted. Assets like these are often handled outside the Ember-CLI build pipeline, but do check to make sure that everything is works as expected.

#### Addon Consumption and Development

It's possible that you have addons which rely on rewriting asset URLs. If there is any impact, it is most likely going to impact users of `ember-cli-deploy`. Please let us know what you discover during this canary/beta process, we'd like to see what each addon is attempting to accomplish and make sure we can support that use case.

#### Everything is Broken! Help!

If for some reason removing `baseURL` and the default `<base>` tag causes tremendous problems, you can add the `<base>` tag directly to your `index.html` file directly:

```html
<base href="/what/your/baseURL/was/" />
```

//TODO but the app.js assets?

### How Can I Try This?

Using our new release channel setup, you can try this change by upgrading your Ember-CLI app to canary:

```sh
npm install --save-dev ember-cli/ember-cli#canary
```

If you discover any problems with this change please [file an issue](https://github.com/ember-cli/ember-cli/issues/new), we'll be paying especially close attention to this topic.
